@model TiendaVirtual.Models.Producto
@using Microsoft.AspNet.Identity

@{
    ViewBag.Title = "CategoryProductsDetails";
}

<div style="display:flex; flex-direction: column; align-items:center; margin-top:30px;">
    <h4 style="font-size: calc(1.405rem + 1.86vw);"><bold>@Html.DisplayFor(model => model.Nombre)</bold></h4>
    <dl class="dl-horizontal">
        <div style="display:flex; flex-direction: row; justify-content:center; align-items:center;">
            @if (Model.Cantidad > 0) 
            {
            <img src="@Html.DisplayFor(model => model.Imagen)" width="700px" style="margin-right: 2%;" />
            }
            else
            {
            <img src="data:image/png;base64,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" width="700px" />
            }
            <div>
                <dt>
                    Stock disponible
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.Cantidad)
                </dd>

                <dd>
                    @Html.DisplayFor(model => model.Precio) €
                </dd>

                <dt>
                    @Html.LabelFor(model => model.Cantidad)
                </dt>

                <dd>
                    <input type="number" id="cantidadInput" value="1" min="1" max="@Model.Cantidad" name="cantidad" style="border: none;
                                                                  background-color: rgba(240, 235, 233, .5); -webkit-background-clip: padding-box;
                                                                  background-clip: padding-box;
                                                                  padding: 8px; border-radius: 10px;" />
                </dd>

                <dd>
                    @if (Request.IsAuthenticated && Model.Cantidad > 0)
                    {
                        if (!User.Identity.Name.Equals("admin@gmail.com"))
                        {
                            <button type="button" class="btn btn-success" id="result" onclick="prueba()" style="padding: 1.214rem 2.4rem;
                            font-size: 1.143rem;
                            line-height: 1.5;
                            border-radius: 2.14286rem;
                            color: #fff;
                            background-color: #e74739;
                            border-color: #e74739;
                            box-shadow: inset 0 1px 0 hsla(0,0%,100%,.15),0 1px 1px rgba(0,0,0,.075);">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-cart" viewBox="0 0 16 16">
                                    <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l1.313 7h8.17l1.313-7H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"></path>
                                </svg>
                                Añadir al carrito
                            </button>
                        }
                    }
                </dd>
            </div>
        </div>

    </dl>
</div>

<p>
    @Html.ActionLink("Volver", "CategoryProducts", "Categorias", new { id = Model.Categoria.Id }, null)
</p>

<!-- Trigger the modal with a button -->
<button id="modal" type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal" style="visibility: hidden">Open Modal</button>

<!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">No hay suficiente stock disponible en estos momentos.</h4>
            </div>
            <div class="modal-body">
                <p>Ha de seleccionar una cantidad dentro del stock disponible.</p>
            </div>
        </div>

    </div>
</div>

<script>
    function prueba() {
        var maxValue = parseInt(@Model.Cantidad);
        var value = parseInt(document.getElementById("cantidadInput").value);
        if (value > 0 && value <= maxValue) {
            var linkpart1 = location.href.split("/Categorias/");
            var url = linkpart1[0] + "/Categorias/AddToCart/" + @Model.Id + "?cantidad=" + document.getElementById("cantidadInput").value;
            location.href = url;
        } else {
            //alert("Inserte una cantidad válida.");
            document.getElementById("modal").click();
        }
    }

</script>